######

#SEGMENTED = expand("Segmented/{image}_segmented.png", image=NAMES)
#MORPHOLOGY = expand("Morphology/{image}_morphology.json", image=NAMES)
images = glob_wildcards('Segmented/{image}_segmented.png').image
MORPHOLOGY = expand("Morphology/{image}_morph.json", image=images)

rule all:
 input:
    MORPHOLOGY

rule Morphological_analysis:
    input:
        image = 'Segmented/{image}_segmented.png',
        metadata = 'Metadata/{image}.json'
        #name = '{image}'
    output: "Morphology/{image}_morph.json"
    params:
        #
        script = srcdir("Scripts/Morphology/morphology.py"),
        name = '{image}'

    conda:
        "Scripts/Morphology/morphology_env.yml"
    shell:
        'python {params.script} {input.image} {input.metadata} {output} {params.name}'
